{"version":3,"file":"index.js","sources":["../h-symbol.vue","../index.ts"],"sourcesContent":["<template>\r\n    <svg :viewBox=\"viewBox\" v-bind=\"attrs\" v-html=\"content\" />\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nimport type { Ref } from 'vue';\r\nimport { computed, ref, watch } from 'vue';\r\nimport type { Filled, IconKey, OpticalSize, Theme, Weight } from '@hyrioo/vite-plugin-material-symbols-svg/consumer';\r\nimport { getSymbol } from '@hyrioo/vite-plugin-material-symbols-svg/consumer';\r\nimport { symbolDefaultProps } from './index';\r\n\r\nexport type SvgColor = string | 'current' | 'keep' | null;\r\n\r\nexport interface HSymbolProps {\r\n    icon: IconKey;\r\n    weight?: Weight;\r\n    theme?: Theme;\r\n    filled?: Filled;\r\n    fills?: SvgColor | SvgColor[] | {[key: string]: SvgColor}\r\n    strokes?: SvgColor | SvgColor[] | {[key: string]: SvgColor}\r\n    size?: number | {width: number, height: number}; // rendered size; used to decide the optical size bucket\r\n    opticalSize?: OpticalSize | null;\r\n}\r\n\r\nconst props = withDefaults(defineProps<HSymbolProps>(), {\r\n    weight: () => symbolDefaultProps.weight,\r\n    theme: () => symbolDefaultProps.theme,\r\n    filled: () => symbolDefaultProps.filled,\r\n    fills: 'current',\r\n    strokes: null,\r\n    size: 24,\r\n    opticalSize: null,\r\n});\r\n\r\n\r\nconst content: Ref<string> = ref('');\r\nconst viewBox: Ref<string> = ref('0 0 24 24');\r\n\r\nconst attrs = computed(() => {\r\n    if (typeof props.size === 'object') {\r\n        return {\r\n            width: props.size.width,\r\n            height: props.size.height,\r\n        };\r\n    }\r\n\r\n    return {\r\n        width: props.size,\r\n        height: props.size,\r\n    };\r\n});\r\n\r\nconst biggestSize = computed(() => {\r\n    if (typeof props.size === 'object') {\r\n        return Math.max(props.size.height, props.size.width);\r\n    }\r\n\r\n    return props.size;\r\n});\r\n\r\nfunction applyColors(content: string, fills: HSymbolProps['fills'], strokes: HSymbolProps['strokes']): string {\r\n    if (!content || typeof DOMParser === 'undefined') return content;\r\n\r\n    const parser = new DOMParser();\r\n    const doc = parser.parseFromString(`<svg xmlns=\"http://www.w3.org/2000/svg\">${content}</svg>`, 'image/svg+xml');\r\n    const svg = doc.documentElement;\r\n    const children = Array.from(svg.children);\r\n\r\n    const applyColor = (el: Element, attr: string, value: any) => {\r\n        if (value === 'keep' || value === null || value === undefined) return;\r\n        el.setAttribute(attr, value === 'current' ? 'currentColor' : value);\r\n    };\r\n\r\n    children.forEach((child, index) => {\r\n        // Apply fills\r\n        if (Array.isArray(fills)) {\r\n            applyColor(child, 'fill', fills[index]);\r\n        } else if (typeof fills === 'object' && fills !== null) {\r\n            const id = child.getAttribute('id');\r\n            if (id && (fills as any)[id] !== undefined) {\r\n                applyColor(child, 'fill', (fills as any)[id]);\r\n            }\r\n        } else if (fills !== undefined) {\r\n            applyColor(child, 'fill', fills);\r\n        }\r\n\r\n        // Apply strokes\r\n        if (Array.isArray(strokes)) {\r\n            applyColor(child, 'stroke', strokes[index]);\r\n        } else if (typeof strokes === 'object' && strokes !== null) {\r\n            const id = child.getAttribute('id');\r\n            if (id && (strokes as any)[id] !== undefined) {\r\n                applyColor(child, 'stroke', (strokes as any)[id]);\r\n            }\r\n        } else if (strokes !== undefined) {\r\n            applyColor(child, 'stroke', strokes);\r\n        }\r\n    });\r\n\r\n    return svg.innerHTML;\r\n}\r\n\r\nfunction updateIcon() {\r\n    const available = getSymbol({\r\n        icon: String(props.icon),\r\n        theme: props.theme,\r\n        filled: props.filled ? 1 : 0,\r\n        weight: Number(props.weight),\r\n    });\r\n\r\n    if (available) {\r\n        const targetSize = props.opticalSize || biggestSize.value;\r\n        const sizes = Object.keys(available).map(Number).sort((a, b) => a - b);\r\n\r\n        let bestSize = targetSize;\r\n        if (!(available as any)[targetSize] && sizes.length > 0) {\r\n            bestSize = sizes.reduce((prev, curr) => {\r\n                return Math.abs(curr - targetSize) < Math.abs(prev - targetSize) ? curr : prev;\r\n            });\r\n        }\r\n\r\n        const svg = (available as any)[bestSize];\r\n        if (svg) {\r\n            content.value = applyColors(svg.content, props.fills, props.strokes);\r\n            viewBox.value = svg.viewBox;\r\n            return;\r\n        }\r\n    }\r\n\r\n    content.value = '';\r\n\r\n    if (symbolDefaultProps.debug) {\r\n        // eslint-disable-next-line no-console\r\n        console.warn(`[h-symbol] Icon not found: ${String(props.icon)} (size ${props.size})`);\r\n    }\r\n}\r\n\r\nwatch(\r\n    () => [props.icon, props.theme, props.filled, props.weight, props.size, props.fills, props.strokes],\r\n    () => updateIcon(),\r\n    { deep: true },\r\n);\r\n\r\nupdateIcon();\r\n</script>\r\n","import { readonly } from 'vue';\r\nimport type { Filled, Theme, Weight } from '@hyrioo/vite-plugin-material-symbols-svg/consumer';\r\nimport { isProduction } from '@hyrioo/vite-plugin-material-symbols-svg';\r\n\r\nexport { default as HSymbol } from './h-symbol.vue';\r\nexport type { HSymbolProps } from './h-symbol.vue';\r\n\r\nexport interface HSymbolDefaultProps {\r\n    weight: Weight;\r\n    theme: Theme;\r\n    filled: Filled;\r\n    debug: boolean;\r\n}\r\n\r\nlet _defaults: HSymbolDefaultProps = {\r\n    weight: 400,\r\n    theme: 'rounded',\r\n    filled: false,\r\n    debug: isProduction,\r\n};\r\nconsole.log('h-symbol debug:', _defaults.debug);\r\n\r\nexport function configureSymbolDefaultProps(\r\n    overrides: Partial<HSymbolDefaultProps>,\r\n) {\r\n    _defaults = {\r\n        ..._defaults,\r\n        ...overrides,\r\n    };\r\n}\r\n\r\nexport const symbolDefaultProps = readonly({\r\n    get weight() {\r\n        return _defaults.weight;\r\n    },\r\n    get theme() {\r\n        return _defaults.theme;\r\n    },\r\n    get filled() {\r\n        return _defaults.filled;\r\n    },\r\n    get debug() {\r\n        return _defaults.debug;\r\n    },\r\n});"],"names":["props","__props","content","ref","viewBox","attrs","computed","biggestSize","applyColors","fills","strokes","svg","children","applyColor","el","attr","value","child","index","id","updateIcon","available","getSymbol","targetSize","sizes","a","b","bestSize","prev","curr","symbolDefaultProps","watch","_createElementBlock","_mergeProps","_hoisted_1","_defaults","isProduction","configureSymbolDefaultProps","overrides","readonly"],"mappings":"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"}